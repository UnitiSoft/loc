import{r as t,g as e,c as s}from"./p-4fe2924d.js";const n=class{constructor(e){t(this,e)}componentDidLoad(){this.el.addEventListener(this.name,t=>{this.prevent&&t.preventDefault(),this.stop&&t.stopPropagation()})}get el(){return e(this)}};async function o(t,e){return await async function(t,e){const s=await fetch(t);return await s[e]()}(t,e)}function a(t,e,s){o(t,e).then(t=>s.emit(t))}const r=class{constructor(e){t(this,e),this.type="json",this.active=!1,this.uniLoadSuccess=s(this,"uniLoadSuccess",7)}urlHandler(t){this.active&&t&&a(t,this.type,this.uniLoadSuccess)}activeHandler(t){t&&this.url&&a(this.url,this.type,this.uniLoadSuccess)}componentDidLoad(){this.active&&this.url&&a(this.url,this.type,this.uniLoadSuccess)}static get watchers(){return{url:["urlHandler"],active:["activeHandler"]}}},c=t=>null!=t&&"object"==typeof t&&!Array.isArray(t);function i(t){return"true"===t||""===t||"false"!==t&&(isNaN(parseFloat(t))?"null"===t?null:t:parseFloat(t))}const u=({type:t,feature:e,separator:s,state:n})=>{switch(t){case"memory":return p(e+s+n);case"local":const t=JSON.parse(localStorage.getItem(e));return n?p(n,t,s):t;case"session":const o=JSON.parse(sessionStorage.getItem(e));return n?p(n,o,s):o;default:return p(e+s+n)}};function l(t,e,s){const n=t.shift();e[n]=e[n]||{},t.length>0?l(t,e[n],s):e[n]=s||e[n]}function h(t,e){const s=t.shift();return t.length>0?h(t,e[s]):e[s]}function f(t,e){const s=Object.assign({},t);return c(t)&&c(e)&&Object.keys(e).forEach(n=>{s[n]=c(e[n])&&n in t?f(t[n],e[n]):e[n]}),s}function p(t,e=window,s="."){return(Array.isArray(t)?t:t.split(s)).reduce((t,e)=>t&&t[e],e)}const d={toggle:t=>{const{feature:e,separator:s,state:n,type:o,value:a}=t;return a?a!==u({type:o,feature:e,separator:s,state:n})&&a:!u({type:o,feature:e,separator:s,state:n})},getLink:t=>t.$event.target.pathname||function(t){let e="";return[].some.call(t,t=>(e=t.pathname||"",!!t.pathname)),e}(t.$event.path)};function O({type:t,feature:e,separator:s,state:n,equal:o,prop:a,elements:r,el:c,$event:l}){if(a){const h=u({type:t,feature:e,separator:s,state:n}),f=o?h===i(o):h,p=JSON.parse(localStorage.getItem("uniStoreDebug"));p&&p[t]&&p[t].includes("listen")&&console.log("%cSTORE LISTEN:","color: darkorange; font-weight: bold",{type:t,feature:e,state:n,prop:a,value:f,element:c,$event:l}),function(t,e,s){[].forEach.call(t,t=>{t[e]=s})}(r,a,f)}}function b(t){return t.feature+(t.state?t.separator+t.state:"")}function w(t,e,s,n){((t,e,s)=>{const n=t.state?function t(e,s){const n=e.shift();return e.length>0?{[n]:t(e,s)}:{[n]:s}}(t.state.split(t.separator),e):e;switch(t.type){case"memory":l(t.feature.split(t.separator),window),l(t.feature.split(t.separator),window,f(h(t.feature.split(t.separator),window),n));break;case"local":const e=JSON.parse(localStorage.getItem(t.feature));(!s||s&&!e)&&localStorage.setItem(t.feature,JSON.stringify(f(e||{},n)));break;case"session":const o=JSON.parse(sessionStorage.getItem(t.feature));(!s||s&&!o)&&sessionStorage.setItem(t.feature,JSON.stringify(f(o||{},n)));break;default:l(t.feature.split(t.separator),window),l(t.feature.split(t.separator),window,f(h(t.feature.split(t.separator),window),n))}})(e,s,n);const o=JSON.parse(localStorage.getItem("uniStoreDebug"));o&&o[e.type]&&o[e.type].includes("set")&&function(t){const e=u(t);console.log("%cSTORE SET:","color: darkred; font-weight: bold",Object.assign(Object.assign({},t),{value:e,$event:void 0}))}(e),document.body.dispatchEvent(new CustomEvent(t,{detail:Object.assign(Object.assign({},e),{value:s})})),c(s)&&function t(e,s,n){for(let[o,a]of Object.entries(n)){const n=e+s.separator+o;c(a)&&t(n,s,a),document.body.dispatchEvent(new CustomEvent(n,{detail:Object.assign(Object.assign({},s),{value:a})}))}}(t,e,s)}const S=class{constructor(e){t(this,e),this.state=null,this.feature="uni.store",this.separator=".",this.type="memory"}componentDidLoad(){const{type:t,feature:e,separator:s,state:n}=this,o={type:t,feature:e,separator:s,state:n};if(this.prop){const{equal:t,prop:e,el:s}=this,n=function(t,e,s){return e?s?t.querySelectorAll(e):[t.querySelector(e)]:null}(s,this.target,this.all),a=Object.assign(Object.assign({},o),{equal:t,prop:e,elements:n,el:s});O(a),document.body.addEventListener(b(o),t=>{O(Object.assign(Object.assign({},a),{$event:t}))})}else if(this.event)this.el.addEventListener(this.event,t=>{const e=Object.assign(Object.assign({},o),{$event:t,value:i(this.value||t.detail)}),s=this.action?d[this.action](e):e.value;w(b(o),o,s,this.init)});else if(this.value){const t=i(this.value);w(b(o),o,t,this.init)}}get el(){return e(this)}};export{n as U,r as a,S as b,o as u}